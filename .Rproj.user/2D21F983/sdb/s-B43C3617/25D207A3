{
    "contents" : "# makes sure the necessary libraries are loaded\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# creates a directory off the current directory to download the data set to and to save the\n# plot to if it doesn't already exist.\nif(!file.exists(\"./pm25airpollution\")){dir.create(\"./pm25airpollution\")}\n\n# checks to see if the zip file has been downloaded and downloads it if it hasn't\nif(!file.exists(\"./pm25airpollution/FNEI_data.zip\")){\n    fileUrl <- \"https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip\"\n    download.file(fileUrl,destfile=\"./pm25airpollution/FNEI_data.zip\")\n} \n\n# checks to see if the zip file has been unzipped and unzips if it hasn't\nif(!file.exists(\"./pm25airpollution/summarySCC_PM25.rds\")){    \n    unzip(\"./pm25airpollution/FNEI_data.zip\", exdir = \"./pm25airpollution\")\n}\n\n\n# reads the data\nNEI <- readRDS(\"./pm25airpollution/summarySCC_PM25.rds\")\nSCC <- readRDS(\"./pm25airpollution/Source_Classification_Code.rds\")\n\n# sets the SCC and year values as factors\nNEI$SCC <- as.factor(NEI$SCC)\nNEI$year <- as.factor(NEI$year)\n\n# filters off just the data from Balitmore City (fips 24510)\nNEI <- filter(NEI, fips == \"24510\" | fips ==\"06037\")\n\n\n# Sums the Emission values for each area, year and and SCC value\nNEISum <-NEI %>%\n    group_by(fips, year, SCC) %>%\n    summarise(Emissions= sum(Emissions))\n\n# pull out the SCC values that have On-Road in the EI sector column\nSCCMV <- SCC[grep(\"On-Road\", SCC$EI.Sector, ignore.case = TRUE), ]\n\n# remove the SCC values from the data that have Non-Road in the EI sector column\nSCCMV <- SCCMV[-grep(\"Non-Road\", SCCMV$EI.Sector, ignore.case = TRUE), ]\n\n# Join the NEI and SCC tables\nNEISum <- inner_join(NEISum, SCCMV, by = \"SCC\")\n\n# summerize the data so that you have a sum for all years based on the EI sector\nyearsummary <- NEISum %>%\n    group_by(fips, year, EI.Sector) %>%\n    summarize(Total.Emission = sum(Emissions))\n\n#make a column for city name based on fips value\nyearsummary <- mutate(yearsummary, city = ifelse(fips == \"06037\", \"Los Angeles\", \"Baltimore\"))\n\n#plot the data\ng <- ggplot(yearsummary, aes(x=year, y=Total.Emission, fill=EI.Sector)) +\n    geom_bar(stat=\"identity\", position = \"stack\") +  \n    scale_fill_discrete(name = \"Motor Vehicle Emissions\",\n                       labels = c(\"Diesel Heavy\\nDuty Vehicles\",\n                                  \"Diesel Light\\nDuty Vehicles\",\n                                  \"Gasoline Heavy\\nDuty Vehicles\",\n                                  \"Gasoline Light\\nDuty Vehicles\")) \ng + facet_grid(.~ city,)\n\n# saves the plot to disk\nggsave(filename=\"./pm25airpollution/plot6.png\", width = 6, height = 3)",
    "created" : 1439683203778.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1477414305",
    "id" : "25D207A3",
    "lastKnownWriteTime" : 1432503543,
    "path" : "C:/Users/Meredith/datasciencecoursera/Exploratory Data Analysis/plot6.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}